<div	style="font-size:18pt">

<h2>Build Scripts in the Developer Environment</h2>

<ol>
	<li><a href="#location">Location of Build Scripts</a></li>
	<li><a href="#lmake">Building Loadable Applications</a></li>
	<ol>
		<li><a href="#lfiles">What should be in this Directory?</a></li>
		<li><a href="#lsource">What should be in this Source File?</a></li>
	</ol>
	<li><a href="#rom">Building and Including Applications in NVRAM</a></li>
	<ol>
		<li><a href="#romapp">Large Fixed Applications</a></li>
		<ol>
			<li><a href="#ffiles">What should be in this Directory?</a></li>
			<li><a href="#fsource">What should be in this Source File?</a></li>
		</ol>
		<li><a href="#bmake">Packed Application Suites in NVRAM</a></li>
		<ol>
			<li><a href="#mfiles">What should be in this Directory?</a></li>
			<li><a href="#msource">What should be in these Source Files?</a></li>
		</ol>
		<li><a href="#cat">NVRAM Application Catenation and Lookup</a></li>
	</ol>
	<li><a href="#auto">Scripts and Automatic Start</a></li>
</ol>

<a	name="location"/>
<h3>1: Location of Build Scripts</h3>
Directory path <a style="color:#FF0000">rta/target.rta/image.app</a> needs to be in your environment

<a	name="amake"/>
<h3>2: Loadable and NVRAM Applications</h3>

<p>
command <a href="#amake">amake</a> builds

<ul	type="square">
	<li>multiple or single dynamically loadable applications of any size</li>

	<li>multiple or single applications of any size for inclusion in NVRAM system image</li>

</ul>
Multiple applications are applications with their instruction part packed into shared iframes in order to optimise instruction memory

<p>
Memory assignment is in multiples of 4K-word pages and applications may ne as compact as a few dozens or hundreds of instructions

<p>
Multiple application instruction parts are assembled relocatable as directed by script make_rel in the application directory
<pre	style="font-size:14pt;color:#0000FF">

	$ cd	rta/application.rta/rom1.app
	$ cat	make_rel

	relt	packed_app1
	relt	packed_app2
	.
	.

</pre>
<p>
If make_rel is absent build advances to absolute assembly of a single application

<p>
Application data memory is always assigned in multiples of 4K-word pages for each process instance of the application

<p>
All applications are shared code and unpack program data into process RAM at process start


<a	name="lmake"/>
<h3>2: Building Loadable Applications</h3>

Loadable applications are constructed with one identifier left unresolved, the start page index of the containing group of iframes

<p>
Application iframes load updates all self-references

<a	name="lfiles"/>
<h4>2.1: What should be in this Directory?</h4>

If the iframe group contains multiple packed applications there must be a script make_rel

<p>
If the iframe group is a single application there may not be a script make_rel

<p>
There must be an applications main assembly file which is either the single application or the linking assembly of packed applications

<p>
If the iframe group contains multiple applications there must be a script make_pro to assemble lookup tags and process launch parameters

<p>
There must be a script loadfs to direct the store and retrieval of application initial data on process start

<p>
loadfs also directs the stored lookup and start parameters of applications if the iframe group contains multiple applications

<a	name="lsource"/>
<h4>2.2: What should be in this Source File?</h4>




<a	name="rom"/>
<h3>3: Building and Including Applications in NVRAM</h3>

NVRAM applications are constructed with all addresses resolved and catenated onto the system image

<h4>3.1: What should be in this Directory?</h4>

If the iframe group contains multiple packed applications there must be a script make_rel

<p>
If the iframe group is a single application there may not be a script make_rel

<p>
There must be an applications main assembly file which is either the single application or the linking assembly of packed applications

<p>
There must be a script make_pro to assemble lookup tags and process launch parameters

<p>
There must be a script loadfs to direct the store and retrieval of application initial data on process start

<p>
loadfs also directs the stored lookup and start parameters of all the applications in the NVRAM iframe group

<p>
There must be a script amass which catenates the application group to the NVRAM system image

<a	name="romapp"/>
<h4>3.1: Single and Multiple NVRAM Applications</h4>

A single NVRAM application in a directory <a style="color:#FF0000">rta/target.rta/<i>application_directory</i></a> has no make_rel script and its make_pro script calls command romprofi

<p>
Sample application counter is in directory rom2.app:
<pre	style="font-size:14pt;color:#0000FF">

	$ cd	rta/target.rta/rom2.app
	$ romapp counter

</pre>

<a	name="ffiles"/>
<h5>3.1.1: What should be in this Directory?</h5>

The directory for a single large NVRAM-based application needs four files

<p>
These examples are four supplied files to construct sample application <a style="color:#FF0000">counter</a> in <a style="color:#FF0000">rta/target.rta/rom2.app</a>
<ul	type="square">

	<li>application source code</li>
	<li>a script called make_pro to construct run parameters
	<pre	style="font-size:14pt;color:#0000FF">

	$ #	application is counter
	$ #	vector value is the offset part of value <a style="color:#FF0000">count</a> exported from assembly
	$ #	run priority is 7 (lowest), one B1 private stack page
	$ #	start page index APPLICATION(2) equated in rta/target.rta/def.app/iframes.def

	$ cat make_pro

	romprofi counter count/*24 7 1 "APPLICATION(2)" 
	</pre>
	</li>
	<li>a text file called loadfs to direct the construction of an embedded file system
	<pre	style="font-size:14pt;color:#0000FF">

	$ #	volume name can be anything
	$ #	application initial data is counter_data, build-linked by assembly name
	$ #	search for lookup names is in directory application_templates
	$ #	there is one lookup name count, launch parameters in file count
	$ #	. end directory application_templates
	$ #	. end root directory

	$ cat	loadfs

	volume embedded
	file counter_data lsegment
	tree application_templates
	file count counter_profile.rom
	.
	.
	</pre>
	</li>
	<li>a script called amass to catenate the total system image</li>
	
</ul>

<a	name="fsource">
<h5>3.1.2: What should be in this Source File?</h5>

<a	name="bmake"/>
<h4>3.2: Packed Application Suites in NVRAM</h4>

<a	name="mfiles"/>
<h5>3.2.1: What should be in this Directory?</h5>

<a	name="msource"/>
<h5>3.2.2: What should be in these Source Files?</h5>

<a	name="cat"/>
<h4>3.3: NVRAM Application Catenation and Lookup</h4>

Basic system image <a style="color:#FF0000">rta/target.rta/initial.app/sysimage.rom</a> contains some supplied applications

<p>
Integrators add more applications with files physically catenated in the last step of build script <a href="#location">romapp or bmake</a>

<p>
The catenated object is a block of one or more pages built in one application directory by romapp or bmake

<p>
Each catenated block contains instruction frames of any number and size and a file system for

<ul	type="none">
	<li>application lookup by name and launch parameters</li>
	<li>initialisation of application static data in RAM</li>
</ul>

<p>
An application may be launched by name interactively or per script. Its launch parameters and lookup name are in its containing block of iframes

<p>
System start reads a file <a style="color:#FF0000">/application_iframes/start_page_index</a> from file system device 1

<p>
File <a style="color:#FF0000">start_page_index</a> is constructed in directory <a style="color:#FF0000">rta/target.rta/def.app</a> with script nvlist. Names <a style="color:#FF0000">APPLICATION(1)..APPLICATION(x)</a> must be in file <a style="color:#FF0000">iframes.def</a>. Finally File System 1 must be generated to with script <a style="color:#FF0000">rta/mrand7</a> and updates come into effect at system start

<p>
<a style="color:#FF0000">APPLICATION(1)</a> must be at 00B000 and <a style="color:#FF0000">APPLICATION(2)</a> depends how large APPLICATION(1) is. Application blocks are in multiples of 4K words
<pre	style="font-size:14pt;color:#0000FF">

	cd	rta/target.rta/def.app
	cat	iframes.def
	<a	style="color:#000000">
	APPLICATION(1)	$equ	00B000
	APPLICATION(2)	$equ	00C000		# for example
	. APPLICATION(3)			# commented until you need it
	</a>
	./nvlist				# construct the NVRAM application blocks list
	cd ../..				# go to directory rta
	./mrand7				# construct File System 1

</pre>
There may be 1024 application blocks APPLICATION(1)..APPLICATION(1024)

<a	name="auto"/>
<h3>4: Scripts and Automatic Start</h3>
</div>
